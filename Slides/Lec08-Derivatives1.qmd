---
title: "Derivatives I"
jupyter: python3
---

## Lecture Overview

Calculus is the branch of mathematics focused on the study of continuous change.

The core concepts of calculus are limits, derivatives, and integrals.

We will need these concepts in our future understanding of:

- Optimization
- Probability

## Lecture Objectives

Review:

- Concepts of limits and single variable derivatives
- Derivative rules:
  - Polynomials, trigonometric, exponential, and log functions
  - Addition, subtraction, multiplication, and division
  - Chain rule
- Taylor's Theorem
- Partial derivatives and the gradient

## Limits

The limit of a function $f(x)$ is defined as

$$
\lim_{x\rightarrow c} f(x) = L.
$$

This definition means that the function $f(x)$ approaches the limit $L$ as $x$ approaches the value $c$.

The value of $L$ need not be finite.

---

More precisely, we say that the limit of a function 
$$
\lim_{x\rightarrow c} f(x) = L,
$$ 

if for any $\varepsilon>0$, there exists a $\delta>0$ such that

$$
\vert f(x) - L\vert < \varepsilon,
$$

for all $x$ such that $\vert x-c\vert < \delta$.

## One-Sided Limits

We can be more specific and have the left-sided limit

$$
\lim_{x\rightarrow c^-{}} f(x),
$$

and the right-sided limit

$$
\lim_{x\rightarrow c^{+}} f(x).
$$

When these values are equal we have

$$
\lim_{x\rightarrow c^-{}} f(x)= \lim_{x\rightarrow c^{+}} f(x) = \lim_{x\rightarrow c} f(x) = L.
$$

## Continuous Functions

A function $f(x)$ is **continuous** at a point $c$ if

$$
\lim_{x \to c} f(x) = f(c).
$$

This means that as $x$ approaches $c$, the value of $f(x)$ approaches $f(c)$, with no jumps, breaks, or holes.

More generally, $f(x)$ is **continuous** on an interval if it is continuous at every point in that interval.

## Examples

Calculate 

$$
\lim_{x\rightarrow 2} x^{2} + 3x + 4 
$$

---

Calculate

$$
\lim_{x\rightarrow 0} \sin{(x)}
$$

---

Calculate

$$
\lim_{x\rightarrow 0} \log{(x)}
$$

---

Calculate

$$
\lim_{x\rightarrow \infty} \frac{1}{x}
$$


## Limit Laws

The following laws assume that $\lim_{x \to c} f(x)$ and $\lim_{x \to c} g(x)$ exist.

1. $\lim_{x \to c} [f(x) + g(x)] = \lim_{x \to c} f(x) + \lim_{x \to c} g(x)$
1. $\lim_{x \to c} [f(x) - g(x)] = \lim_{x \to c} f(x) - \lim_{x \to c} g(x)$
1. $\lim_{x \to c} [c \cdot f(x)] = c \cdot \lim_{x \to c} f(x)$
1. $\lim_{x \to c} [f(x) \cdot g(x)] = \lim_{x \to c} f(x) \cdot \lim_{x \to c} g(x)$
1. $\lim_{x \to c} \left[\frac{f(x)}{g(x)}\right] = \frac{\lim_{x \to c} f(x)}{\lim_{x \to c} g(x)}$ *provided* $\lim_{x \to c} g(x) \ne 0$

## Composite Limit Law

If $\lim_{x \to c} g(x) = L$ and $f$ is continuous at $L$, i.e., $\lim_{x \to L} f(x) = f(L)$, then  
$$
\lim_{x \to c} f(g(x)) = f\left(\lim_{x \to c} g(x)\right) = f(L).
$$


These laws help simplify the evaluation of limits and are foundational for understanding continuity and derivatives.

## Some Famous Limits

1. $\lim_{x\rightarrow 0}\frac{\sin(x)}{x} = 1$
1. $\lim_{x\rightarrow 0} \frac{\ln(x+1)}{x} = 1$
1. $\lim_{x\rightarrow 0} (1+x)^{1/x} = e$
1. $\lim_{x\rightarrow\infty} \left(1+\frac{1}{x}\right)^{x} = e$
1. $\lim_{h\rightarrow 0}\frac{e^{h}-1}{h} = 1$

## What is a Sequence?

A **sequence** is an ordered list of numbers:

$$
a_0, a_1, a_2, a_3, \dots
$$

Each term may be defined by a rule or formula, such as:

- Arithmetic: $a_n = a + nd$
- Geometric: $a_n = ar^n$

## Notation

We often write sequences as:

$$
\{a_n\}_{n=0}^{\infty}.
$$

Sequences are the building blocks of **series**, which are sums of sequence terms.


## Series


A **series** is the sum of the terms of a sequence:

$$
\sum_{i=0}^{\infty} a_i.
$$

- If the sequence has a pattern, we can often find a closed-form expression.

## Geometric Series

A **geometric series** has the form:

$$
\sum_{i=0}^{\infty} ar^i = a + ar + ar^2 + ar^3 + \dots
$$

- $a$: first term  
- $r$: common ratio

Examples:

- $a = 1, r = \frac{1}{2}$, then $\sum_{i=0}^{\infty}\left(\frac{1}{2}\right)^{i} = 1 + \frac{1}{2} + \frac{1}{4} + \dots$


## Convergence Criteria

A geometric series converges **if and only if**:

$$
\vert r\vert < 1.
$$

Then the sum is:

$$
\sum_{i=0}^{\infty} ar^i = \frac{a}{1 - r}.
$$

## Divergence

If $\vert r\vert \geq 1$, the series **diverges** (i.e., grows without bound or oscillates).

Examples:

- $r = \frac{1}{2}$: converges
- $r = 2$: diverges

::: {.notes}
Harmonic series, the sequence of naturally occurring overtones that make up a single musical pitch!
:::

## Example

Evaluate:

$$
\sum_{i=0}^{\infty} \frac{1}{2^i}.
$$

This is a geometric series with:

- $a = 1$
- $r = \frac{1}{2}$

---

### Apply the formula:

$$
\sum_{i=0}^{\infty} \frac{1}{2^i} = \frac{1}{1 - \frac{1}{2}} = \frac{1}{\frac{1}{2}} = 2
$$


## Derivative Definition

The derivative $f^{\prime}(x)$ of single-variable real-valued function $f(x)$ at the point $x$ is

$$
f^{\prime}(x) = \lim_{h\rightarrow 0} \frac{f(x+h)-f(x)}{h}.
$$

Functions for which the derivative exists over their defined domain are called *differentiable*.

---

Other common notations for a derivative are

$$
f^{\prime}(x) = \frac{d}{dx}f(x) = \frac{df}{dx}.
$$


---

```{python}
#| fig-align: center
import numpy as np
import matplotlib.pyplot as plt

# Define the function and its derivative
def f(x):
  return x**2

def df(x):
  return 2*x

# Point to illustrate derivative
x0 = 1.5
h = 0.5

# Compute slope using definition
slope_secant = (f(x0 + h) - f(x0)) / h
slope_tangent = df(x0)

# Plot function
x = np.linspace(0, 3, 100)
y = f(x)

plt.figure(figsize=(8, 5))
plt.plot(x, y, label='$f(x) = x^2$')

# Secant line
x_secant = np.array([x0, x0 + h])
y_secant = f(x_secant)
plt.plot(x_secant, y_secant, 'ro-', label=r'$(f(x_{0}+h)-f(x_{0}))/h$')

# Tangent line at x0
tangent_line = slope_tangent * (x - x0) + f(x0)
plt.plot(x, tangent_line, 'g--', label=r'$f^{\prime}(x_{0})$')

plt.scatter([x0], [f(x0)], color='black', zorder=5)
plt.text(x0, f(x0)+0.5, f'$x_0={x0}$', ha='center')

plt.xlabel('$x$')
plt.ylabel('$f(x)$')
plt.legend()
plt.title('Derivative as Slope: Secant and Tangent Lines')
plt.grid(True)
plt.show()
```

## Polynomial

The differentiation rules for polynomials are

$$
\frac{d}{dx}x^{n} = n x^{n-1}.
$$

---

For example, if $f(x) = x^{3}$ calculate $f^{\prime}(x)$

:::: {.fragment}
$$
f^{\prime}(x) = 3x^{2}.
$$
::::

---

If $f(x) = \sqrt{x}$ what is $f^{\prime}(x)$?

:::: {.fragment}
$$
f^{\prime}(x)= \frac{1}{2\sqrt{x}}.
$$
::::

::: {.notes}
$$
\frac{d}{dx}\sqrt{x} = \frac{d}{dx}x^{\frac{1}{2}} = \frac{1}{2}x^{-\frac{1}{2}}=  \frac{1}{2\sqrt{x}}
$$
:::

---

How do we calculate derivatives of more complex functions such as

$$
f(x) = 10x^{2} - 3x^{6} - x^{-\frac{3}{2}}?
$$


## Addition Rule

For differentiable functions $f(x)$ and $g(x)$

$$
(f(x) + g(x))^{\prime} = f^{\prime}(x) + g^{\prime}(x) 
$$

---

In addition let $c$ be a constant, then

$$
(cf(x))^{\prime}(x) = cf^{\prime}(x).
$$

Therefore,

$$
(f(x) - g(x))^{\prime} = f^{\prime}(x) - g^{\prime}(x).
$$

---

How do we calculate derivatives of more complex polynomials such as $f(x) = 10x^{2} - 3x^{6} - x^{-\frac{3}{2}}?$

:::: {.fragment}
$$
f^{\prime}(x) = 20x - 18x^{5} + \frac{3}{2}x^{-\frac{5}{2}}.
$$
::::

## Trigonometric Function Derivatives

The derivative rules for $\sin$ and $\cos$ are 

$$
\begin{align}
\frac{d}{dx}\sin{(x)} &= \cos{(x)} \\
\frac{d}{dx}\cos{(x)} &= -\sin{(x)} \\
\end{align}
$$

--- 

Let's prove the derivative for $\sin$. By definition we have to compute

$$
\lim_{h\rightarrow 0} \frac{\sin{(x+h)}-\sin{(x)}}{h}.
$$

::: {.notes}
Recall the angle addition formula for sine:
$$
\sin(x+h) = \sin(x)\cos(h) + \cos(x)\sin(h)
$$

So,
$$
\frac{\sin(x+h) - \sin(x)}{h} = \frac{\sin(x)\cos(h) + \cos(x)\sin(h) - \sin(x)}{h}
$$

Group terms:
$$
= \frac{\sin(x)(\cos(h) - 1) + \cos(x)\sin(h)}{h}
$$

Take the limit as $h \to 0$:
$$
\lim_{h \to 0} \frac{\sin(x)(\cos(h) - 1)}{h} + \lim_{h \to 0} \frac{\cos(x)\sin(h)}{h}
$$

We know:
- $\lim_{h \to 0} \frac{\sin(h)}{h} = 1$
- $\lim_{h \to 0} \frac{\cos(h) - 1}{h} = 0$

Therefore,
$$
f'(x) = \sin(x) \cdot 0 + \cos(x) \cdot 1 = \cos(x)
$$

So,
$$
\frac{d}{dx}\sin(x) = \cos(x)
$$
:::

--- 

How could we derive these for other trigonometric functions like 

$$
\small
\begin{align}
\tan{(x)} &= \frac{\sin{(x)}}{\cos{(x)}}, \\
\csc{(x)} &= \frac{1}{\sin{(x)}}, \\ 
\sec{(x)} &= \frac{1}{\cos{(x)}}, \\
\cot{(x)} &= \frac{1}{\tan{(x)}} ?
\end{align}
$$

We need help from the multiplication and quotient rules.


## Product Rule

For differentiable functions $f(x)$ and $g(x)$ 

$$
(f(x)g(x))^{\prime} = f^{\prime}(x)g(x) + f(x)g^{\prime}(x).
$$


## Quotient Rule

For differentiable functions $f(x)$ and $g(x)\neq 0$ 

$$
\left(\frac{f(x)}{g(x)}\right)^{\prime} = \frac{f^{\prime}(x)g(x) - f(x)g^{\prime}(x)}{(g(x))^{2}}.
$$

---

Let's derive $\frac{d}{dx}\tan{(x)}$:

$$
\frac{d}{dx}\tan{(x)} =\frac{d}{dx} \left(\frac{\sin{(x)}}{\cos{(x)}}\right)
$$

## Exponential

The derivative of the exponential function is

$$
\frac{d}{dx}e^{x}= e^{x}.
$$

## Logarithm

The derivative of the logarithm function is

$$
\frac{d}{dx}\log{(x)}= \frac{1}{x}.
$$

## Chain Rule

For differentiable functions $f(x)$ and $g(x)$ 

$$
f(g(x))^{\prime} = f^{\prime}(g(x))g^{\prime}(x).
$$

Alternatively if $h(x) = f(g(x))$ then

$$
h^{\prime}(x) = \frac{dh}{dx} = \frac{df}{dg}\frac{dg}{dx}.
$$

## Higher-Order Derivatives

We can define second- and higher-order derivatives using our definitions. The following is a second derivative:

$$
f^{\prime\prime}(x) = \frac{d^{2}}{dx^{2}} f(x) = \lim_{h\rightarrow 0} \frac{f^{\prime}(x+h)-f^{\prime}(x)}{h}.
$$

For higher-order derivatives we have

$$
f^{(n)}(x) = \frac{d^{n}}{dx^{n}}f(x).
$$

## Partial Derivatives

We can extend the concept of a derivative to functions of 2 or more variables. Consider a real-valued function $f(x,y)$.

The partial derivative of $f$ with respect to $x$ is

$$
\small
\frac{\partial}{\partial x}f(x,y) = f_{x}(x, y) = \lim_{h\rightarrow 0} \frac{f(x+h, y) - f(x,y)}{h}.
$$

Similarly, the partial derivative of $f$ with respect to $y$ is

$$
\small
\frac{\partial}{\partial y}f(x,y) = f_{y}(x, y) = \lim_{h\rightarrow 0} \frac{f(x, y+h) - f(x,y)}{h}.
$$

---

For a real-valued function $f: \mathbb{R}^{n} \rightarrow \mathbb{R}$ the $i$th partial derivative is

$$
\scriptsize
\frac{\partial}{\partial x_{i}}f(x_{1},x_{2},\ldots,x_{n}) = \lim_{h\rightarrow 0} \frac{f(x_{1},\dots, x_{i}+h,\ldots, x_{n}) - f(x_{1},\dots, x_{i},\ldots, x_{n})}{h}
$$

---

Higher-order partial derivatives are defined similarly. For example, the second partial derivative of $f(x,y)$ is

$$
\small
\frac{\partial^{2}}{\partial x^{2}}f(x,y) = f_{xx}(x, y) = \lim_{h\rightarrow 0} \frac{f_{x}(x+h, y) - f_{x}(x,y)}{h}.
$$

## Gradients

Given a real-valued function $f(\mathbf{x})$ with $\mathbf{x}\in\mathbb{R}^{n}$, the gradient is a vector consisting of all partial derivatives of $f$:

$$
\nabla f(\mathbf{x}) = 
\begin{bmatrix}
\frac{\partial}{\partial x_{1}}f(\mathbf{x}) \\
\frac{\partial}{\partial x_{2}}f(\mathbf{x}) \\
\vdots \\
\frac{\partial}{\partial x_{n}}f(\mathbf{x}) \\
\end{bmatrix}.
$$

## Taylor Series

The Taylor series of a real function $f(x)$ that is infinitely differentiable at a real number $c$ is the infinite *power series*

$$
f(x) = \sum_{n=0}^{\infty}\frac{f^{(n)}(c)(x-c)^{n}}{n!}.
$$


---

If we let $f(x)=e^{x}$ and $c=0$ we obtain the famous formula

$$
f(x) = \sum_{n=0}^{\infty}\frac{x^{n}}{n!}.
$$

## Taylor's Theorem

Let $k$ be an integer and let the function $f:\mathbb{R}\rightarrow \mathbb{R}$ be $k$ times differentiable at the point $c\in\mathbb{R}$. Then there exists a function $h_{k}:\mathbb{R}\rightarrow \mathbb{R}$ such that

$$
\small
f(x) = \sum_{n=0}^{k} \frac{f^{(n)}(c)(x-c)^{n}}{n!} + h_{k}(x)(x-c)^{k+1},
$$
and

$$
\small
\lim_{x\rightarrow c}h_{k}(x) = 0.
$$

## Summary

We covered:

- limits
- derivatives, higher-order derivatives, partial derivatives
- gradient vector
- Taylor series and Taylor's Theorem
